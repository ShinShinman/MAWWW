{"version":3,"file":"ma.js","sources":["ma.coffee"],"names":[],"mappings":"AAAA;AAAA,MAAA;;EAAM;;;IAAN,MAAA,GAAA;MAuHC,cAAgB,CAAA,CAAA;AACf,YAAA;QAAA,EAAE,CAAC,QAAQ,CAAC,WAAZ,GAA0B;QAC1B,KAAA,GAAQ,CAAA,CAAE,qBAAF,CAAwB,CAAC;QACjC,CAAA,CAAE,eAAF,CAAkB,CAAC,WAAnB,CAA+B;UAC9B,IAAA,EAAM,KAAA,GAAQ,CADgB;UAE9B,KAAA,EAAO,CAFuB;UAG9B,IAAA,EAAM,IAHwB;UAI9B,UAAA,EAAY,IAJkB;UAK9B,QAAA,EAAU,IALoB;UAM9B,eAAA,EAAiB,IANa;UAO9B,UAAA,EAAY;QAPkB,CAA/B,EAFA;;QAYA,cAAA,CAAe;UACd,eAAA,EAAiB;QADH,CAAf;QAIA,CAAA,CAAE,eAAF,CAAkB,CAAC,KAAnB,CAAyB,QAAA,CAAA,CAAA;AACxB,cAAA;UAAA,QAAA,GAAW,CAAA,CAAE,eAAF,CAAkB,CAAC,MAAnB,CAAA,CAAA,GAA8B;UACzC,OAAO,CAAC,GAAR,CAAY,QAAZ;iBACA,CAAA,CAAE,YAAF,CAAe,CAAC,OAAhB,CAAwB;YACvB,SAAA,EAAW;UADY,CAAxB,EAEG,GAFH;QAHwB,CAAzB;QAOA,gBAAA,CAAiB,eAAjB;MAxBe;;MA0ChB,cAAgB,CAAC,OAAD,CAAA;AACf,YAAA;QAAA,QAAA,GAAW,CAAC,CAAC,MAAF,CAAU,CAAA;;UAEpB,KAAA,EAAO,OAFa;UAGpB,eAAA,EAAiB;QAHG,CAAV,EAIR,OAJQ;eAMX,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,GAAtB,CAA2B;UAC1B,OAAA,EAAS,QAAQ,CAAC,KADQ;UAE1B,iBAAA,EAAmB,QAAQ,CAAC;QAFF,CAA3B;MAPe;;MAYhB,EAAI,CAAC,OAAD,CAAA;AACH,YAAA,KAAA,EAAA,aAAA,EAAA,cAAA,EAAA,OAAA,EAAA,aAAA,EAAA,YAAA,EAAA,IAAA,EAAA,QAAA,EAAA,OAAA,EAAA;QAAA,QAAA,GAAW,CAAC,CAAC,MAAF,CAEV,CAAA;;UAAA,IAAA,EAAM,EAAE,CAAC,QAAQ,CAAC,IAAlB;UACA,IAAA,EAAM,EAAE,CAAC,QAAQ,CAAC,QADlB;UAEA,MAAA,EAAQ,KAFR;UAGA,UAAA,EAAY,CAAA,CAAE,SAAF,CAHZ;UAIA,WAAA,EAAa,CAAC,IAAD,EAAO,IAAP,CAJb;UAKA,WAAA,EAAa,KALb;UAMA,gBAAA,EAAkB,CAAA,CAAE,uCAAF;QANlB,CAFU,EASR,OATQ;QAWX,QAAQ,CAAC,IAAI,CAAC,OAAd,CACC;UAAA,YAAA,EAAc,QAAQ,CAAC,QAAvB;UACA,OAAA,EACC;YAAA,MAAA,EAAQ;UAAR;QAFD,CADD,EAXA;;QAiBA,aAAA,GAAgB,QAAA,CAAA,CAAA;AACf,cAAA,IAAA,EAAA,UAAA,EAAA;UAAA,IAAA,GAAO,QAAQ,CAAC,KAAhB;;UAEA,OAAA,GAAU,QAAQ,CAAC,IAAI,CAAC,KAAd,CAAoB,iBAApB;UACV,UAAA,GAAa,OAAA,IAAY,OAAQ,CAAA,CAAA;iBACjC,UAAA,IAAe,kBAAA,CAAmB,UAAnB;QALA;QAOhB,OAAA,GAAU,CAAA,CAAE,aAAF;QACV,cAAA,GAAiB,CAAA,CAAE,kCAAF;QAEjB,KAAA,GAAQ,CAAA,CAAE,4BAAF;QACR,OAAA,GAAU,CAAA,CAAE,sBAAF;QAEV,KAAK,CAAC,KAAN,CAAY,QAAA,CAAC,CAAD,CAAA;UACX,CAAC,CAAC,cAAF,CAAA;UACA,OAAO,CAAC,WAAR,CAAoB,iBAApB;UACA,CAAA,CAAE,IAAF,CAAI,CAAC,IAAL,CAAA;UACA,OAAO,CAAC,SAAR,CAAkB,EAAlB,EAAsB,QAAQ,CAAC,KAA/B,EAAsC,MAAM,CAAC,QAAQ,CAAC,QAAtD;iBACA,QAAQ,CAAC,IAAI,CAAC,OAAd,CACC;YAAA,MAAA,EAAQ;UAAR,CADD;QALW,CAAZ;QAQA,OAAO,CAAC,KAAR,CAAc,QAAA,CAAC,CAAD,CAAA;UACb,CAAC,CAAC,cAAF,CAAA;UACA,OAAO,CAAC,WAAR,CAAoB,iBAApB;UACA,OAAO,CAAC,SAAR,CAAkB,EAAlB,EAAsB,QAAQ,CAAC,KAA/B,EAAsC,MAAM,CAAC,QAAQ,CAAC,QAAtD;UACA,QAAQ,CAAC,IAAI,CAAC,OAAd,CACC;YAAA,MAAA,EAAQ;UAAR,CADD;UAEA,IAAG,QAAQ,CAAC,MAAZ;YACG,QAAQ,CAAC,UAAU,CAAC,MAApB,CAA2B,QAA3B,EAAqC,CAAC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAtB,EAA0B,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA/C,CAArC;mBACA,YAAA,CAAa,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAlC,EAAsC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA3D,EAFH;;QANa,CAAd;QAUA,cAAc,CAAC,KAAf,CAAqB,QAAA,CAAC,CAAD,CAAA;UACpB,CAAC,CAAC,cAAF,CAAA;UACA,OAAO,CAAC,QAAR,CAAiB,iBAAjB;UACA,CAAA,CAAE,IAAF,CAAI,CAAC,MAAL,CAAA,CAAa,CAAC,WAAd,CAA0B,iBAA1B;UACA,OAAO,CAAC,IAAR,CAAa,eAAb,CAA6B,CAAC,IAA9B,CAAA;UACA,CAAA,CAAE,IAAF,CAAI,CAAC,MAAL,CAAA,CAAa,CAAC,IAAd,CAAmB,eAAnB,CAAmC,CAAC,IAApC,CAAA;iBACA,QAAQ,CAAC,IAAT,GAAgB,SAAA,GAAY,kBAAA,CAAmB,CAAA,CAAE,IAAF,CAAI,CAAC,IAAL,CAAU,QAAV,CAAnB;QANR,CAArB;QAQA,YAAA,GAAe,QAAA,CAAA,CAAA;AACd,cAAA;UAAA,UAAA,GAAa,aAAA,CAAA;UACb,IAAG,CAAC,UAAJ;AACC,mBADD;WADA;;UAIA,OAAO,CAAC,QAAR,CAAiB,iBAAjB;UACA,OAAO,CAAC,MAAR,CAAA,CAAgB,CAAC,IAAjB,CAAsB,GAAA,GAAM,UAA5B,CAAuC,CAAC,WAAxC,CAAoD,iBAApD,CAAsE,CAAC,IAAvE,CAA4E,eAA5E,CAA4F,CAAC,IAA7F,CAAA;iBACA,QAAQ,CAAC,IAAI,CAAC,OAAd,CACC;YAAA,MAAA,EAAQ,GAAA,GAAM;UAAd,CADD;QAPc;QAUf,CAAA,CAAE,MAAF,CAAS,CAAC,EAAV,CAAa,YAAb,EAA2B,YAA3B,EAlEA;;QAoEA,YAAA,CAAA,EApEA;;QAuEA,YAAA,GAAe,QAAA,CAAC,KAAD,EAAQ,KAAR,CAAA;iBACb,CAAA,CAAE,cAAF,CAAiB,CAAC,IAAlB,CAAuB,GAAA,GAAM,KAAN,GAAc,GAAd,GAAoB,KAA3C;QADa;QAGf,aAAA,GAAgB,QAAA,CAAC,KAAD,EAAQ,KAAR,CAAA;AACf,cAAA;UAAA,QAAQ,CAAC,gBAAgB,CAAC,GAA1B,CAA8B,EAA9B;UACA,KAAA,GAAQ,CAAA,CAAE,QAAF,CAAW,CAAC,MAAZ,CAAoB,QAAA,CAAC,KAAD,CAAA;AAC3B,gBAAA,KAAA,EAAA,QAAA,EAAA;YAAA,KAAA,GAAQ,CAAA,CAAE,IAAF;YACR,QAAA,GAAW,KAAK,CAAC,IAAN,CAAW,OAAX,CAAmB,CAAC,KAApB,CAA0B,iBAA1B;YACX,IAAG,QAAH;cACC,IAAA,GAAO,QAAA,CAAS,QAAS,CAAA,CAAA,CAAlB;cACP,IAAG,IAAA,IAAQ,KAAR,IAAkB,IAAA,IAAQ,KAA7B;uBAAwC,KAAxC;eAAA,MAAA;uBAAkD,MAAlD;eAFD;aAAA,MAAA;qBAIC,MAJD;;UAH2B,CAApB;iBASR,QAAQ,CAAC,IAAI,CAAC,OAAd,CAAsB;YAAC,MAAA,EAAO;UAAR,CAAtB;QAXe;QAahB,IAAG,QAAQ,CAAC,MAAZ;UACC,CAAA,CAAE,SAAF,CACA,CAAC,MADD,CAEC;YAAA,KAAA,EAAO,IAAP;YACA,GAAA,EAAK,QAAQ,CAAC,WAAY,CAAA,CAAA,CAD1B;YAEA,GAAA,EAAK,QAAQ,CAAC,WAAY,CAAA,CAAA,CAF1B;YAGA,MAAA,EAAQ,CAAC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAtB,EAA0B,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA/C,CAHR;YAIA,IAAA,EAAM,QAAA,CAAC,CAAD,EAAI,EAAJ,CAAA;cACL,aAAA,CAAc,EAAE,CAAC,MAAO,CAAA,CAAA,CAAxB,EAA4B,EAAE,CAAC,MAAO,CAAA,CAAA,CAAtC;qBACA,YAAA,CAAa,EAAE,CAAC,MAAO,CAAA,CAAA,CAAvB,EAA2B,EAAE,CAAC,MAAO,CAAA,CAAA,CAArC;YAFK;UAJN,CAFD,CASA,CAAC,MATD,CASQ,MATR,EAUC;YAAA,IAAA,EAAM;UAAN,CAVD,CAWA,CAAC,MAXD,CAWQ,OAXR;UAYA,YAAA,CAAa,CAAA,CAAE,SAAF,CAAY,CAAC,MAAb,CAAoB,QAApB,EAA8B,CAA9B,CAAb,EAA+C,CAAA,CAAE,SAAF,CAAY,CAAC,MAAb,CAAoB,QAApB,EAA8B,CAA9B,CAA/C,EAbD;SAvFA;;QAuGA,IAAA,GAAO,QAAA,CAAA,CAAA,EAAA;AAEN,cAAA,QAAA,EAAA,QAAA,EAAA,IAAA,EAAA,OAAA;;UAAA,IAAA,GAAO,CAAA,CAAE,uBAAF;UACP,QAAA,GAAW,CAAA,CAAE,sCAAF;UACX,OAAA,GAAU;UAEV,QAAA,GAAW,QAAA,CAAC,EAAD,EAAK,SAAL,CAAA;AACV,gBAAA,SAAA,EAAA,OAAA,EAAA;YAAA,OAAA,GAAU;YACV,QAAA,GAAW,QAAA,GAAW;AACtB,mBAAO,SAAA,GAAY,QAAA,CAAA,CAAA;AAClB,kBAAA,KAAA,EAAA,IAAA,EAAA;cAAA,YAAA,CAAa,OAAb;cACA,IAAA,GAAO;cACP,KAAA,GAAQ;cACR,OAAA,GAAU,QAAA,CAAA,CAAA;gBACT,EAAE,CAAC,KAAH,CAAS,KAAT,EAAgB,IAAhB;cADS;cAGV,OAAA,GAAU,UAAA,CAAW,OAAX,EAAoB,SAApB;YAPQ;UAHT;iBAaX,QAAQ,CAAC,gBAAgB,CAAC,KAA1B,CAAgC,QAAA,CAAS,QAAA,CAAA,CAAA;AACxC,gBAAA,QAAA,EAAA,SAAA,EAAA;YAAA,GAAA,GAAM,QAAQ,CAAC,gBAAgB,CAAC,GAA1B,CAAA,CAA+B,CAAC,KAAhC,CAAsC,GAAtC;YACN,CAAC,CAAC,IAAF,CAAO,GAAP,EAAY,QAAA,CAAC,CAAD,EAAI,CAAJ,CAAA;qBACX,GAAI,CAAA,CAAA,CAAJ,GAAS,OAAA,GAAU,CAAV,GAAc;YADZ,CAAZ;YAGA,SAAA,GAAY,GAAG,CAAC,IAAJ,CAAS,EAAT;YACZ,QAAA,GAAW,IAAI,MAAJ,CAAW,SAAA,GAAY,IAAvB,EAA6B,IAA7B;mBACX,QAAQ,CAAC,IAAI,CAAC,OAAd,CACC;cAAA,MAAA,EAAQ,QAAA,CAAA,CAAA;uBACP,CAAA,CAAE,IAAF,CAAO,CAAC,IAAR,CAAA,CAAc,CAAC,KAAf,CAAqB,QAArB;cADO;YAAR,CADD;UAPwC,CAAT,EAU9B,GAV8B,CAAhC;QAnBM;QA+BP,IAAG,QAAQ,CAAC,WAAZ;UACC,IAAA,CAAA;UACA,CAAA,CAAE,uBAAF,CAA0B,CAAC,EAA3B,CAA8B,OAA9B,EAAuC,QAAA,CAAC,CAAD,CAAA;YACtC,UAAA,CAAW,QAAA,CAAA,CAAA;cACV,QAAQ,CAAC,IAAI,CAAC,OAAd,CACC;gBAAA,MAAA,EAAQ;cAAR,CADD;cAEA,IAAG,QAAQ,CAAC,MAAZ;gBACC,QAAQ,CAAC,UAAU,CAAC,MAApB,CAA2B,QAA3B,EAAqC,CAAC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAtB,EAA0B,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA/C,CAArC;gBACA,YAAA,CAAa,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAlC,EAAsC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA3D,EAFD;;YAHU,CAAX;UADsC,CAAvC;UASA,QAAQ,CAAC,gBAAgB,CAAC,KAA1B,CAAgC,QAAA,CAAA,CAAA;YAC/B,QAAQ,CAAC,UAAU,CAAC,MAApB,CAA2B,QAA3B,EAAqC,CAAC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAtB,EAA0B,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA/C,CAArC;mBACA,YAAA,CAAa,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAlC,EAAsC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA3D;UAF+B,CAAhC;UAGA,OAAO,CAAC,GAAR,CAAY,oBAAZ,EAdD;;MAvIG;;MAyJJ,GAAK,CAAC,OAAD,CAAA,EAAA;AACJ,YAAA,aAAA,EAAA,QAAA,EAAA;QAAA,QAAA,GAAW,CAAC,CAAC,MAAF,CAEV,CAAA;;UAAA,IAAA,EAAM,EAAE,CAAC,QAAQ,CAAC,IAAlB;UACA,MAAA,EAAQ,CAAA,CAAE,SAAF,CADR;UAEA,WAAA,EAAa,CAAC,IAAD,EAAO,IAAP;QAFb,CAFU,EAKR,OALQ;QAOX,YAAA,GAAe,QAAA,CAAC,KAAD,EAAQ,KAAR,CAAA;iBACb,CAAA,CAAE,cAAF,CAAiB,CAAC,IAAlB,CAAuB,GAAA,GAAM,KAAN,GAAc,GAAd,GAAoB,KAA3C;QADa;QAGf,aAAA,GAAgB,QAAA,CAAC,KAAD,EAAQ,KAAR,CAAA;AACf,cAAA;UAAA,KAAA,GAAQ,CAAA,CAAE,QAAF,CAAW,CAAC,MAAZ,CAAoB,QAAA,CAAC,KAAD,CAAA;AAC3B,gBAAA,KAAA,EAAA,QAAA,EAAA;YAAA,KAAA,GAAQ,CAAA,CAAE,IAAF;YACR,QAAA,GAAW,KAAK,CAAC,IAAN,CAAW,OAAX,CAAmB,CAAC,KAApB,CAA0B,iBAA1B;YACX,IAAG,QAAH;cACC,IAAA,GAAO,QAAA,CAAS,QAAS,CAAA,CAAA,CAAlB;cACP,IAAG,IAAA,IAAQ,KAAR,IAAkB,IAAA,IAAQ,KAA7B;uBAAwC,KAAxC;eAAA,MAAA;uBAAkD,MAAlD;eAFD;aAAA,MAAA;qBAIC,MAJD;;UAH2B,CAApB;iBASR,CAAA,CAAE,mBAAF,CAAsB,CAAC,OAAvB,CAA+B;YAAC,MAAA,EAAO;UAAR,CAA/B;QAVe;eAYhB,CAAC,CAAC,SAAF,CAAY,wCAAZ,EAAsD,QAAA,CAAA,CAAA;iBACrD,CAAC,CAAC,SAAF,CAAY,oDAAZ,EAAkE,QAAA,CAAA,CAAA;YACjE,CAAA,CAAE,SAAF,CACA,CAAC,MADD,CAEC;cAAA,KAAA,EAAO,IAAP;cACA,GAAA,EAAK,QAAQ,CAAC,WAAY,CAAA,CAAA,CAD1B;cAEA,GAAA,EAAK,QAAQ,CAAC,WAAY,CAAA,CAAA,CAF1B;cAGA,MAAA,EAAQ,CAAC,QAAQ,CAAC,WAAY,CAAA,CAAA,CAAtB,EAA0B,QAAQ,CAAC,WAAY,CAAA,CAAA,CAA/C,CAHR;cAIA,IAAA,EAAM,QAAA,CAAC,CAAD,EAAI,EAAJ,CAAA;gBACL,aAAA,CAAc,EAAE,CAAC,MAAO,CAAA,CAAA,CAAxB,EAA4B,EAAE,CAAC,MAAO,CAAA,CAAA,CAAtC;uBACA,YAAA,CAAa,EAAE,CAAC,MAAO,CAAA,CAAA,CAAvB,EAA2B,EAAE,CAAC,MAAO,CAAA,CAAA,CAArC;cAFK;YAJN,CAFD,CASA,CAAC,MATD,CASQ,MATR,EAUC;cAAA,IAAA,EAAM;YAAN,CAVD,CAWA,CAAC,MAXD,CAWQ,OAXR;mBAYA,YAAA,CAAa,CAAA,CAAE,SAAF,CAAY,CAAC,MAAb,CAAoB,QAApB,EAA8B,CAA9B,CAAb,EAA+C,CAAA,CAAE,SAAF,CAAY,CAAC,MAAb,CAAoB,QAApB,EAA8B,CAA9B,CAA/C;UAbiE,CAAlE;QADqD,CAAtD;MAvBI;;MAuCL,cAAgB,CAAC,IAAD,EAAO,GAAP,CAAA;AACf,YAAA;QAAA,MAAA,GAAS;QACT,CAAC,CAAC,IAAF,CACC;UAAA,GAAA,EAAK,CAAA,2CAAA,CAAA,CAA8C,MAA9C,CAAA,CAAL;UACA,IAAA,EAAM,KADN;UAEA,QAAA,EAAU,MAFV;UAGA,KAAA,EAAO,QAAA,CAAC,KAAD,EAAQ,UAAR,EAAoB,WAApB,CAAA;mBACN,OAAO,CAAC,GAAR,CAAY,CAAA,YAAA,CAAA,CAAe,UAAf,CAAA,CAAZ;UADM,CAHP;UAKA,OAAA,EAAS,QAAA,CAAC,IAAD,EAAO,UAAP,EAAmB,KAAnB,CAAA,EAAA;;YAER,IAAG,IAAA,KAAU,IAAV,IAAmB,IAAA,KAAU,IAAhC;qBACC,MAAM,CAAC,QAAQ,CAAC,OAAhB,CAAwB,CAAA,CAAA,CAAG,GAAH,CAAA,CAAxB,EADD;;UAFQ;QALT,CADD;MAFe;;MAchB,eAAiB,CAAA,CAAA;AAChB,YAAA;QAAA,MAAA,GAAS;QACT,CAAC,CAAC,IAAF,CACC;UAAA,GAAA,EAAK,CAAA,oCAAA,CAAA,CAAuC,MAAvC,CAAA,CAAL;UACA,IAAA,EAAM,KADN;UAEA,QAAA,EAAU,MAFV;UAGA,KAAA,EAAO,QAAA,CAAC,KAAD,EAAQ,UAAR,EAAoB,WAApB,CAAA;mBACN,OAAO,CAAC,GAAR,CAAY,CAAA,YAAA,CAAA,CAAe,UAAf,CAAA,CAAZ;UADM,CAHP;UAKA,OAAA,EAAS,QAAA,CAAC,IAAD,EAAO,UAAP,EAAmB,KAAnB,CAAA;mBACR,OAAO,CAAC,GAAR,CAAY,CAAA,kBAAA,CAAA,CAAqB,IAArB,CAA0B,6CAA1B,CAAA,CAAyE,IAAA,GAAK,IAA9E,CAAmF,MAAnF,CAAZ;UADQ;QALT,CADD;MAFgB,CAzXjB;;;MAifA,OAAS,CAAC,CAAD,EAAI,QAAQ,CAAZ,CAAA;AACR,YAAA,QAAA,EAAA,MAAA,EAAA;QAAA,MAAA,GAAS,CAAA,CAAE,WAAF;QACT,IAAG,CAAA,KAAK,EAAR;AACC,iBADD;;QAEA,GAAA,GAAM,CAAA,CAAA,CAAG,SAAU,CAAA,GAAA,CAAb,CAAkB,6BAAlB,CAAA,CAAiD,CAAjD,CAAmD,OAAnD,CAAA,CAA4D,KAA5D,CAAkE,MAAlE,CAAA,CAA0E,IAA1E,CAAA;QACN,QAAA,GAAW;QACX,MAAM,CAAC,IAAP,CAAA,EALA;;QAOA,KAAA,CAAM,GAAN,CACC,CAAC,IADF,CACO,MAAA,QAAA,CAAC,QAAD,CAAA;AACL,cAAA;UAAA,OAAA,GAAU,CAAA,MAAM,QAAQ,CAAC,IAAT,CAAA,CAAN;UACV,QAAA,GAAW,OAAO,CAAC,QAAQ,CAAC;UAC5B,QAAA,GAAW,IAAI,CAAC,IAAL,CAAU,QAAA,GAAW,IAArB;UACX,CAAA,CAAE,yBAAF,CAA4B,CAAC,IAA7B,CAAkC,CAAA,WAAA,CAAA,CAAc,YAAA,CAAa,QAAb,CAAd,CAAA,CAAlC,CAAyE,CAAC,WAA1E,CAAsF,SAAtF;UACA,UAAA,CAAW,KAAX,EAAkB,QAAlB,EAA4B,CAA5B;iBACA,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAtB,CAA8B,MAAA,QAAA,CAAC,GAAD,EAAM,CAAN,CAAA;YAC7B,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAjB,CAAyB,QAAzB,EAAmC,CAAA,MAAM,QAAA,CAAS,GAAT,CAAN,CAAnC;YACA,IAAI,CAAA,GAAI,CAAJ,KAAS,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAnC;cACC,MAAM,CAAC,IAAP,CAAA;cACA,CAAA,CAAE,gBAAF,CAAmB,CAAC,IAApB,CAAA;cACA,CAAA,CAAE,UAAF,CAAa,CAAC,QAAd,CAAuB;gBACtB,SAAA,EAAW,IADW;gBAEtB,aAAA,EAAgB;cAFM,CAAvB,EAFA;;;cAQA,IAAG,QAAA,CAAS,cAAc,CAAC,OAAf,CAAuB,YAAvB,CAAT,CAAA,KAAkD,KAArD;uBACC,MAAM,CAAC,MAAP,CAAc;kBACb,GAAA,EAAK,cAAc,CAAC,OAAf,CAAuB,gBAAvB,CADQ;kBAEb,QAAA,EAAU;gBAFG,CAAd,EADD;eATD;;UAF6B,CAA9B;QANK,CADP,CAuBC,CAAC,KAvBF,CAuBQ,QAAA,CAAC,KAAD,CAAA;iBACN,OAAO,CAAC,KAAR,CAAc,KAAd;QADM,CAvBR;MARQ;;MA2FT,IAAM,CAAC,GAAD,CAAA;eACL,GAAG,CAAC,KAAJ,CAAU,QAAA,CAAC,CAAD,CAAA;UACT,IAAG,CAAC,CAAA,CAAE,IAAF,CAAO,CAAC,GAAR,CAAA,CAAJ;YACC,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAtB,CAAA;AACA,mBAFD;;AAGA,kBAAO,CAAC,CAAC,KAAT;AAAA,iBACM,EADN;cAEE,IAAG,cAAA,KAAkB,CAAC,CAAtB;gBAA6B,WAAY,CAAA,cAAA,CAAe,CAAC,SAAS,CAAC,MAAtC,CAA6C,WAA7C,EAA7B;;cACA,IAAG,cAAA,GAAiB,CAApB;gBAA2B,cAAA,GAA3B;eAAA,MAAA;gBACK,cAAA,GAAiB,WAAW,CAAC,MAAZ,GAAqB,EAD3C;;qBAEA,WAAY,CAAA,cAAA,CAAe,CAAC,SAAS,CAAC,GAAtC,CAA0C,WAA1C;AALF,iBAMM,EANN;cAOE,IAAG,cAAA,KAAkB,CAAC,CAAtB;gBAA6B,WAAY,CAAA,cAAA,CAAe,CAAC,SAAS,CAAC,MAAtC,CAA6C,WAA7C,EAA7B;;cACA,IAAG,cAAA,GAAiB,WAAW,CAAC,MAAZ,GAAqB,CAAzC;gBAAgD,cAAA,GAAhD;eAAA,MAAA;gBACK,cAAA,GAAiB,EADtB;;qBAEA,WAAY,CAAA,cAAA,CAAe,CAAC,SAAS,CAAC,GAAtC,CAA0C,WAA1C;AAVF,iBAWM,EAXN;qBAYE,GAAG,CAAC,GAAJ,CAAQ,WAAY,CAAA,cAAA,CAAe,CAAC,UAAU,CAAC,WAA/C,CAA2D,CAAC,MAA5D,CAAA;AAZF;qBAaM,OAAA,CAAQ,kBAAA,CAAmB,CAAA,CAAE,IAAF,CAAO,CAAC,GAAR,CAAA,CAAnB,CAAR;AAbN;QAJS,CAAV;MADK,CA5kBN;;;MAgnBA,IAAM,CAAA,CAAA;QACL,YAAA,CAAa,aAAb,EAA4B,UAA5B;QACA,UAAA,CAAW,WAAX,EAAwB,QAAxB,EADA;;QAGA,UAAU,CAAC,MAAX,CAAkB;UACjB,aAAA,EAAe,CADE;UAEjB,eAAA,EAAiB,IAFA;UAGjB,aAAA,EAAe;QAHE,CAAlB;eAKA,UAAU,CAAC,GAAX,CAAA;MATK;;IAlnBP;;;IAEC,UAAA,GAAa,CAAA,CAAE,cAAF;;IACb,aAAA,GAAgB,CAAA,CAAE,iBAAF;;IAChB,WAAA,GAAc,CAAA,CAAE,eAAF;;IACd,QAAA,GAAW,CAAA,CAAE,YAAF;;;IAGX,IAAA,GAAO,CAAA,CAAE,mBAAF;;IACP,QAAA,GAAW;;;IAGX,EAAC,CAAA,QAAD,GACC;MAAA,SAAA,EAAW,CAAA,CAAE,aAAF,CAAX;MACA,UAAA,EAAY,CAAA,CAAE,cAAF,CADZ;MAEA,aAAA,EAAe,CAAA,CAAE,iBAAF,CAFf;MAGA,WAAA,EAAa,CAAA,CAAE,eAAF,CAHb;MAIA,QAAA,EAAU,CAAA,CAAE,YAAF,CAJV;MAKA,cAAA,EAAgB,KALhB;MAMA,IAAA,EAAM,CAAA,CAAE,mBAAF,CANN;MAOA,QAAA,EAAU,QAPV;MAQA,WAAA,EAAa,KARb;MASA,gBAAA,EAAkB,KATlB;MAUA,eAAA,EAAoB,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,QAAzB,CAAkC,MAAlC,CAAH,GAAkD,IAAlD,GAA4D,IAV7E;MAWA,SAAA,EAAW,CAAA,CAAE,cAAF;IAXX;;;IAeD,YAAA,GAAe,QAAA,CAAC,OAAD,EAAU,MAAV,CAAA;aACd,OAAO,CAAC,KAAR,CAAc,QAAA,CAAA,CAAA;eACb,MAAM,CAAC,GAAP,CAAW,SAAX,EAAsB,QAAA,CAAC,CAAD,EAAI,OAAJ,CAAA;UACrB,IAAG,OAAA,GAAU,CAAb;mBAAoB,EAApB;WAAA,MAAA;mBAA2B,EAA3B;;QADqB,CAAtB;MADa,CAAd;IADc;;IAMf,QAAA,GAAW,QAAA,CAAA,CAAA;AACV,UAAA,MAAA,EAAA,YAAA,EAAA;MAAA,MAAA,GAAS,EAAE,CAAC,QAAQ,CAAC;MACrB,OAAA,GAAU,EAAE,CAAC,QAAQ,CAAC;MACtB,EAAE,CAAC,QAAQ,CAAC,cAAZ,GAA6B;MAC7B,MAAM,CAAC,IAAP,CAAA,CAAa,CAAC,MAAd,CAAA,CAAsB,CAAC,IAAvB,CAA4B,OAA5B,EAAqC,UAArC,CAAgD,CAAC,QAAjD,CAA0D,UAA1D,CAAqE,CAAC,GAAtE,CAA0E,QAA1E,EAAoF,OAApF;MACA,cAAA,CAAe;QACd,KAAA,EAAO,OADO;QAEd,eAAA,EAAiB;MAFH,CAAf;MAIA,YAAA,GAAe,CAAA,CAAE,MAAF,CAAS,CAAC,MAAV,CAAA,CAAA,GAAqB;MACpC,OAAO,CAAC,IAAR,CAAa,GAAb;MACA,MAAM,CAAC,GAAP,CAAW,QAAX,EAAqB,YAArB,CAAkC,CAAC,gBAAnC,CAAoD;QACnD,eAAA,EAAiB;MADkC,CAApD;IAXU;;IAgBX,SAAA,GAAY,QAAA,CAAA,CAAA;AACX,UAAA,MAAA,EAAA;MAAA,MAAA,GAAS,EAAE,CAAC,QAAQ,CAAC;MACrB,OAAA,GAAU,EAAE,CAAC,QAAQ,CAAC;MACtB,EAAE,CAAC,QAAQ,CAAC,cAAZ,GAA6B;MAC7B,MAAM,CAAC,MAAP,CAAA,CAAe,CAAC,IAAhB,CAAqB,OAArB,EAA8B,WAA9B;MACA,MAAM,CAAC,IAAP,CAAA,CAAa,CAAC,MAAd,CAAA,CAAsB,CAAC,WAAvB,CAAmC,UAAnC,CAA8C,CAAC,GAA/C,CAAmD,QAAnD,EAA6D,MAA7D;MACA,cAAA,CAAe;QACd,KAAA,EAAO,OADO;QAEd,eAAA,EAAiB;MAFH,CAAf,EALA;;MAUA,OAAO,CAAC,IAAR,CAAa,GAAb;IAXW;;IAcZ,UAAA,GAAa,QAAA,CAAC,OAAD,EAAU,MAAV,CAAA;aACZ,OAAO,CAAC,KAAR,CAAc,QAAA,CAAA,CAAA;AACb,YAAA;QAAA,aAAA,GAAgB,MAAM,CAAC,MAAP,CAAA,CAAe,CAAC,IAAhB,CAAqB,OAArB;QAChB,IAAG,aAAA,KAAiB,WAApB;iBACC,QAAA,CAAA,EADD;SAAA,MAAA;iBAGC,SAAA,CAAA,EAHD;;MAFa,CAAd;IADY;;IAQb,YAAA,GAAe,QAAA,CAAC,MAAD,EAAS,IAAT,CAAA;aACd,CAAA,CAAE,MAAF,CAAS,CAAC,IAAV,CAAgB,QAAA,CAAA,CAAA;eACf,IAAI,CAAC,OAAL,CAAa;UACZ,YAAA,EAAc,IADF;UAEZ,OAAA,EAAS;YACR,MAAA,EAAQ;UADA;QAFG,CAAb;MADe,CAAhB;IADc;;IAUf,cAAA,GAAiB,QAAA,CAAC,OAAD,CAAA;AAChB,UAAA;MAAA,QAAA,GAAW,CAAC,CAAC,MAAF,CAAU,CAAA;;QAEpB,KAAA,EAAO,OAFa;QAGpB,eAAA,EAAiB;MAHG,CAAV,EAIR,OAJQ;aAMX,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,GAAtB,CAA2B;QAC1B,OAAA,EAAS,QAAQ,CAAC,KADQ;QAE1B,iBAAA,EAAmB,QAAQ,CAAC;MAFF,CAA3B;IAPgB;;IAYjB,gBAAA,GAAmB,QAAA,CAAC,aAAD,CAAA;AAClB,UAAA,QAAA,EAAA,SAAA,EAAA;MAAA,MAAA,GAAS,CAAA,CAAE,aAAF,CAAgB,CAAC,MAAjB,CAAA,CAAA,GAA4B;MACrC,QAAA,GAAW,CAAC,CAAD,EAAI,CAAJ;MACX,SAAA,GAAY;MAEZ,CAAA,CAAE,MAAF,CAAS,CAAC,MAAV,CAAiB,QAAA,CAAA,CAAA;QAChB,QAAQ,CAAC,GAAT,CAAA;QACA,QAAQ,CAAC,IAAT,CAAc,CAAA,CAAE,MAAF,CAAS,CAAC,SAAV,CAAA,CAAd;QACA,QAAQ,CAAC,OAAT,CAAA;QACA,SAAA,GAAe,QAAS,CAAA,CAAA,CAAT,GAAc,QAAS,CAAA,CAAA,CAA1B,GAAkC,MAAlC,GAA8C,KAH1D;;QAMA,IAAG,CAAA,CAAE,MAAF,CAAS,CAAC,SAAV,CAAA,CAAA,GAAwB,MAAxB,IAAoC,CAAI,EAAE,CAAC,QAAQ,CAAC,cAAvD;UACC,cAAA,CAAe;YACd,eAAA,EAAiB;UADH,CAAf,EADD;SANA;;QAYA,IAAG,CAAA,CAAE,MAAF,CAAS,CAAC,SAAV,CAAA,CAAA,IAAyB,MAAzB,IAAqC,CAAI,EAAE,CAAC,QAAQ,CAAC,cAAxD;iBACC,cAAA,CAAe;YACd,eAAA,EAAiB;UADH,CAAf,EADD;;MAbgB,CAAjB;IALkB;;IAoDnB,kBAAA,GAAqB,QAAA,CAAC,IAAD,CAAA;AACpB,UAAA,KAAA,EAAA,OAAA,EAAA,aAAA,EAAA,UAAA,EAAA,UAAA,EAAA;MAAA,KAAA,GAAQ,CAAA,CAAE,IAAF;MACR,OAAA,GAAU,CAAA,CAAE,MAAF;MAEV,UAAA,GAAa,OAAO,CAAC,SAAR,CAAA;MACb,aAAA,GAAgB,UAAA,GAAa,OAAO,CAAC,MAAR,CAAA;MAE7B,OAAA,GAAU,KAAK,CAAC,MAAN,CAAA,CAAc,CAAC;MACzB,UAAA,GAAa,OAAA,GAAU,KAAK,CAAC,MAAN,CAAA;AAEvB,aAAQ,CAAC,UAAA,IAAc,aAAf,CAAA,IAAiC,CAAC,OAAA,IAAW,UAAZ;IAVrB;;;;IAyPrB,GAAA,GAAS,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAvB,CAAgC,YAAhC,CAAH,GAAsD,MAAtD,GAAkE;;;IAGxE,KAAA,GAAQ,QAAA,CAAC,MAAD,CAAA;AACP,aAAO,MAAM,CAAC,OAAP,CAAe,6CAAf,EAA8D,WAA9D;IADA;;;IAIR,QAAA,GAAW,QAAA,CAAC,MAAD,EAAS,GAAT,CAAA;AACV,UAAA,UAAA,EAAA;MAAA,UAAA,GAAa,CAAC,CAAC,MAAF,CAAS;QACrB,CAAA,EAAG,GADkB;QAErB,CAAA,EAAG,GAFkB;QAGrB,CAAA,EAAG,GAHkB;QAIrB,CAAA,EAAG,GAJkB;QAKrB,CAAA,EAAG,GALkB;QAMrB,CAAA,EAAG,GANkB;QAOrB,CAAA,EAAG,GAPkB;QAQrB,CAAA,EAAG,GARkB;QASrB,CAAA,EAAG;MATkB,CAAT,EAUV,GAVU;MAWb,SAAA,GAAY,MAAM,CAAC,WAAP,CAAA,CAAoB,CAAC,KAArB,CAA2B,EAA3B;MACZ,SAAS,CAAC,OAAV,CAAkB,QAAA,CAAC,EAAD,EAAK,CAAL,CAAA;QACjB,IAAG,UAAW,CAAA,EAAA,CAAd;iBACC,SAAU,CAAA,CAAA,CAAV,GAAe,UAAW,CAAA,EAAA,EAD3B;;MADiB,CAAlB;AAGA,aAAO,SAAS,CAAC,IAAV,CAAe,EAAf;IAhBG;;;;;;IAsBX,OAAA,GACC;MAAA,KAAA,EAAO,CAAA,CAAA,CAAG,MAAM,CAAC,QAAQ,CAAC,MAAnB,CAA0B,WAA1B,CAAP;MACA,IAAA,EAAM,CAAA,CAAA,CAAG,MAAM,CAAC,QAAQ,CAAC,MAAnB,CAAA;IADN;;;IAGD,SAAA,GACC;MAAA,KAAA,EAAO,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,uBAAhB,CAAP;MACA,IAAA,EAAM,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,iBAAhB;IADN;;;IAGD,KAAA,GAAQ;;IACR,IAAA,GAAO;;IACP,QAAA,GAAW;;IAIX,WAAA,GACC;MAAA,KAAA,EAAO,uBAAP;MACA,IAAA,EAAM;IADN;;;;;;;;;IAWD,QAAA,GAAW,QAAA,CAAC,EAAD,CAAA;AACV,UAAA,OAAA,EAAA,SAAA,EAAA,GAAA,EAAA,SAAA,EAAA,IAAA,EAAA,KAAA,EAAA,YAAA,EAAA,OAAA,EAAA;MAAA,KAAA,GACC;QAAA,EAAA,EAAO,EAAE,CAAC,aAAN,GAAyB,KAAA,CAAM,EAAE,CAAC,aAAT,CAAzB,GAAsD,EAA1D;QACA,EAAA,EAAO,EAAE,CAAC,yBAAN,GAAqC,EAAE,CAAC,yBAAxC,GAAuE;MAD3E;MAED,YAAA,GAAe,KAAM,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ;MACrB,OAAA,GAAa,EAAE,CAAC,OAAN,GAAmB,EAAE,CAAC,OAAO,CAAC,IAAX,CAAgB,IAAhB,CAAnB,GAA8C;MACxD,SAAA,GAAe,EAAE,CAAC,SAAN,GAAqB,EAAE,CAAC,SAAxB,GAAuC;MACnD,OAAA,GAAa,EAAE,CAAC,eAAN,GAA2B,CAAA,CAAA,CAAG,EAAE,CAAC,eAAgB,CAAA,CAAA,CAAtB,CAAyB,oBAAzB,CAA3B,GAA+E,GANzF;;;MASA,KAAA,GAAW,EAAE,CAAC,WAAN,GAAuB,EAAE,CAAC,WAAY,CAAA,CAAA,CAAf,GAAoB,GAA3C,GAAoD;MAC5D,SAAA,GAAe,EAAE,CAAC,YAAN,GAAwB,IAAI,CAAC,KAAL,CAAY,EAAE,CAAC,YAAa,CAAA,CAAA,CAAhB,GAAqB,KAAjC,CAAxB,GAAsE;MAClF,IAAA,GACC;QAAA,EAAA,EAAI,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,oBAAhB,CAAA,CAAsC,EAAE,CAAC,cAAzC,CAAwD,CAAxD,CAAJ;QACA,EAAA,EAAI,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,oBAAhB,CAAA,CAAsC,EAAE,CAAC,cAAzC,CAAwD,CAAxD;MADJ;MAED,GAAA,GAAS,OAAH,GAAgB,CAAA,8CAAA,CAAA,CAIT,SAJS,CAIC,UAJD,CAAA,CAKZ,OAAQ,CAAA,GAAA,CALI,CAKC,uFALD,CAAA,CAMsC,OANtC,CAM8C,UAN9C,CAAA,CAOZ,OAPY,CAOJ,EAPI,CAAA,CAOA,YAPA,CAOa,KAPb,CAAhB,GASG;aACT,CAAA,CAAE,CAAA,mCAAA,CAAA,CAEW,IAAK,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAFhB,CAE6C,gCAF7C,CAAA,CAG6B,YAH7B,CAG0C,mCAH1C,CAAA,CAI6B,OAJ7B,CAIqC,cAJrC,CAAA,CAKQ,SALR,CAKkB,QALlB,CAAA,CAMG,GANH,CAMO,mBANP,CAAF;IAzBU;;;IAqCX,YAAA,GAAe,QAAA,CAAC,KAAD,CAAA;AACd,UAAA,cAAA,EAAA,eAAA,EAAA;MAAA,iBAAA,GAAoB;MACpB,eAAA,GAAkB;MAClB,cAAA,GAAiB;MACjB,IAAG,KAAA,KAAS,CAAZ;AACC,eAAO,CAAA,CAAA,CAAG,KAAH,EAAA,CAAA,CAAY,iBAAZ,CAAA,EADR;OAAA,MAEK,IAAG,KAAA,GAAQ,EAAR,IAAc,CAAd,IAAoB,KAAA,GAAO,EAAP,IAAa,CAAjC,IAAuC,CAAC,KAAA,GAAQ,GAAR,GAAc,EAAd,IAAoB,KAAA,GAAQ,GAAR,IAAe,EAApC,CAA1C;AACJ,eAAO,CAAA,CAAA,CAAG,KAAH,EAAA,CAAA,CAAY,eAAZ,CAAA,EADH;OAAA,MAAA;AAGJ,eAAO,CAAA,CAAA,CAAG,KAAH,EAAA,CAAA,CAAY,cAAZ,CAAA,EAHH;;IANS;;;IAgDf,UAAA,GAAa,QAAA,CAAC,KAAD,EAAQ,QAAR,EAAkB,CAAlB,CAAA;AACZ,UAAA,CAAA,EAAA,CAAA,EAAA,OAAA,EAAA,MAAA,EAAA,QAAA,EAAA,IAAA,EAAA,cAAA,EAAA,GAAA,EAAA,IAAA,EAAA,GAAA,EAAA;MAAA,CAAA,GAAO,CAAA,KAAK,GAAR,GAAiB,EAAjB,GAAyB;MAC7B,cAAA,GAAiB,CAAA,CAAE,qBAAF;MACjB,IAAA,GAAO,KAAA,GAAQ,IAAR,GAAe;MACtB,QAAA,GAAW,IAAA,GAAO;MAClB,MAAA,GAAY,CAAC,IAAA,GAAO,CAAR,CAAA,GAAa,QAAhB,GAA8B,QAA9B,GAA4C,IAAA,GAAO;MAC5D,GAAA,GACC;QAAA,EAAA,EAAI,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,yBAAhB,CAAJ;QACA,EAAA,EAAI,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,qBAAhB;MADJ;MAED,MAAA,GAAS;MACT,KAAU,yGAAV;QACC,IAAG,CAAA,GAAI,CAAP;UACC,OAAA,GAAU,IAAI,CAAC,GAAL,CAAS,CAAT,CAAA,GAAc,MAAd,GAAuB;UACjC,IAAG,OAAA,IAAW,QAAd;AAA4B,qBAA5B;;UACA,MAAM,CAAC,OAAP,CAAe,CAAA,aAAA,CAAA,CAAgB,GAAI,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAApB,CAAiD,GAAjD,CAAA,CAAsD,CAAtD,CAAwD,OAAxD,CAAA,CAAiE,CAAC,OAAA,GAAU,CAAX,CAAA,GAAgB,EAAjF,CAAoF,EAApF,CAAA,CAAwF,OAAxF,CAAgG,SAAhG,CAAf,EAHD;SAAA,MAIK,IAAG,CAAA,KAAK,IAAR;UAAkB,cAAc,CAAC,MAAf,CAAsB,CAAA,4BAAA,CAAA,CAA+B,GAAI,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAAnC,CAAgE,GAAhE,CAAA,CAAqE,CAArE,CAAuE,OAAvE,CAAA,CAAgF,CAAC,CAAA,GAAI,CAAL,CAAA,GAAU,EAA1F,CAA6F,EAA7F,CAAA,CAAiG,CAAjG,CAAmG,SAAnG,CAAtB,EAAlB;SAAA,MAAA;UACA,cAAc,CAAC,MAAf,CAAsB,CAAA,aAAA,CAAA,CAAgB,GAAI,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAApB,CAAiD,GAAjD,CAAA,CAAsD,CAAtD,CAAwD,OAAxD,CAAA,CAAiE,CAAC,CAAA,GAAI,CAAL,CAAA,GAAU,EAA3E,CAA8E,EAA9E,CAAA,CAAkF,CAAlF,CAAoF,SAApF,CAAtB,EADA;;MALN;MAOA,IAAG,IAAA,GAAO,CAAV;QAAiB,cAAc,CAAC,OAAf,CAAuB,CAAA,aAAA,CAAA,CAAgB,GAAI,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAApB,CAAiD,GAAjD,CAAA,CAAsD,CAAtD,CAAwD,+CAAxD,CAAvB,EAAjB;;MACA,cAAc,CAAC,MAAf,CAAsB,MAAtB;MACA,IAAG,MAAA,KAAU,QAAb;QAA2B,cAAc,CAAC,MAAf,CAAsB,CAAA,wCAAA,CAAA,CAA2C,GAAI,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAA/C,CAA4E,GAA5E,CAAA,CAAiF,CAAjF,CAAmF,OAAnF,CAAA,CAA4F,CAAC,QAAA,GAAW,CAAZ,CAAA,GAAiB,EAA7G,CAAgH,EAAhH,CAAA,CAAoH,QAApH,CAA6H,SAA7H,CAAtB,EAA3B;;MACA,IAAG,IAAA,KAAQ,CAAX;QAAkB,cAAc,CAAC,OAAf,CAAuB,CAAA,sCAAA,CAAA,CAAyC,GAAI,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAA7C,CAA0E,GAA1E,CAAA,CAA+E,CAA/E,CAAiF,OAAjF,CAAA,CAA0F,CAAC,IAAA,GAAO,CAAR,CAAA,GAAa,EAAvG,CAA0G,qBAA1G,CAAvB,EAAlB;;MACA,IAAG,IAAA,KAAQ,QAAX;eAAyB,cAAc,CAAC,MAAf,CAAsB,CAAA,sCAAA,CAAA,CAAyC,GAAI,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAA7C,CAA0E,GAA1E,CAAA,CAA+E,CAA/E,CAAiF,OAAjF,CAAA,CAA2F,IAAA,GAAO,EAAlG,CAAsG,mBAAtG,CAAtB,EAAzB;;IArBY;;;IAwBb,YAAA,GAAe,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,0CAAhB;;IACf,cAAA,GAAiB,CAAC;;IAClB,WAAA,GAAc;;;IAGd,gBAAA,GAAmB,QAAA,CAAC,WAAD,CAAA;AAClB,UAAA;MAAA,OAAA,GACC;QAAA,EAAA,EAAI,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,4BAAhB,CAAJ;QACA,EAAA,EAAI,CAAA,CAAA,CAAG,OAAQ,CAAA,GAAA,CAAX,CAAgB,wBAAhB;MADJ;MAED,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,KAAtB,CAAA;MACA,WAAW,CAAC,OAAZ,CAAoB,QAAA,CAAC,IAAD,CAAA;AACnB,YAAA;QAAA,IAAG,OAAO,IAAP,KAAe,QAAlB;AAAgC,iBAAhC;;QACA,IAAA,GAAO,IAAI,CAAC,OAAL,CAAa,SAAb,EAAwB,EAAxB;QACP,GAAA,GAAM,OAAQ,CAAA,EAAE,CAAC,QAAQ,CAAC,eAAZ,CAAR,GAAuC,kBAAA,CAAmB,IAAnB;eAC7C,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAtB,CAA6B,CAAA,aAAA,CAAA,CAAgB,GAAhB,CAAoB,EAApB,CAAA,CAAwB,IAAxB,CAA6B,SAA7B,CAA7B;MAJmB,CAApB;MAKA,cAAA,GAAiB,CAAC;aAClB,WAAA,GAAc,QAAQ,CAAC,gBAAT,CAA0B,iBAA1B;IAXI;;;IAcnB,OAAA,GAAU,QAAA,CAAC,CAAD,CAAA;AACT,UAAA;MAAA,GAAA,GAAM,CAAA,CAAA,CAAG,SAAU,CAAA,GAAA,CAAb,CAAkB,+GAAlB,CAAA,CAAmI,SAAA,CAAU,CAAV,CAAY,CAAC,OAAb,CAAqB,KAArB,EAA4B,GAA5B,CAAnI,CAAoK,EAApK;aACN,KAAA,CAAM,GAAN,CACC,CAAC,IADF,CACO,MAAA,QAAA,CAAC,GAAD,CAAA;AACL,YAAA;QAAA,OAAA,GAAU,CAAA,MAAM,GAAG,CAAC,IAAJ,CAAA,CAAN,EAAV;;QAEA,IAAG,OAAO,CAAC,KAAK,CAAC,YAAY,CAAC,MAA3B,GAAoC,CAAvC;UACC,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAtB,CAAA;iBACA,gBAAA,CAAiB,OAAO,CAAC,KAAK,CAAC,YAA/B,EAFD;;MAHK,CADP,CAOC,CAAC,KAPF,CAOQ,QAAA,CAAC,GAAD,CAAA;eACN,OAAO,CAAC,KAAR,CAAc,GAAd;MADM,CAPR;IAFS;;IAiCV,OAAA,GAAU,QAAA,CAAA,CAAA;aACT,OAAO,CAAC,GAAR,CAAY,uBAAZ;IADS;;;iBAIV,GAAA,GACC;MAAA,OAAA,EAAS,OAAT;MACA,QAAA,EAAU,QADV;MAEA,SAAA,EAAW,SAFX;MAGA,gBAAA,EAAkB,gBAHlB;MAIA,YAAA,EAAc,YAJd;MAKA,IAAA,EAAM,EAAE,CAAC,QAAQ,CAAC,IALlB;MAMA,QAAA,EAAU,QANV;MAOA,YAAA,EAAc;IAPd;;;;;;EAsBF,MAAM,CAAC,EAAP,GAAY,IAAI,EAAJ,CAAA,EA9nBZ;;;EAioBA,CAAA,CAAE,QAAA,CAAA,CAAA;AACD,QAAA,IAAA,EAAA;IAAA,MAAM,CAAC,EAAE,CAAC,IAAV,CAAA,EAAA;;IAGA,IAAA,GAAO,CAAA,CAAE,4BAAF;IACP,KAAA,GAAQ,CAAA,CAAE,uBAAF;WACR,IAAI,CAAC,KAAL,CAAW,QAAA,CAAC,CAAD,CAAA;MACV,CAAC,CAAC,cAAF,CAAA;aACA,KAAK,CAAC,WAAN,CAAA;IAFU,CAAX;EANC,CAAF;AAjoBA","sourcesContent":["class MA\r\n\t# Menu vars\r\n\tsearchForm = $('#search-form')\r\n\tsearchTrigger = $('.search-trigger')\r\n\tmenuTrigger = $('.menu-trigger')\r\n\tmainMenu = $('.main-menu')\r\n\r\n\t# Isotope grid vars\r\n\tgrid = $('.bricks-container')\r\n\tgridItem = '.brick'\r\n\r\n\t# Scope problems\r\n\t@settings =\r\n\t\tstickyNav: $('.sticky-nav')\r\n\t\tsearchForm: $('#search-form')\r\n\t\tsearchTrigger: $('.search-trigger')\r\n\t\tmenuTrigger: $('.menu-trigger')\r\n\t\tmainMenu: $('.main-menu')\r\n\t\tmainMenuOpened: false\r\n\t\tgrid: $('.bricks-container')\r\n\t\tgridItem: '.brick'\r\n\t\thighlightOn: false\r\n\t\thighlightVisible: false\r\n\t\tcurrentLanguage: if window.location.pathname.includes('/pl/') then 'pl' else 'en'\r\n\t\tsuggester: $('ul.suggester')\r\n\r\n\t# Private methods\r\n\r\n\tsearchToggle = (trigger, target) ->\r\n\t\ttrigger.click ->\r\n\t\t\ttarget.css('opacity', (i, opacity) ->\r\n\t\t\t\tif opacity > 0 then 0 else 1\r\n\t\t\t)\r\n\r\n\topenMenu = ->\r\n\t\ttarget = MA.settings.mainMenu\r\n\t\ttrigger = MA.settings.menuTrigger\r\n\t\tMA.settings.mainMenuOpened = true\r\n\t\ttarget.show().parent().data('state', 'extended').addClass('extended').css('height', '100vh')\r\n\t\tstickyNavSetup({\r\n\t\t\tcolor: 'white',\r\n\t\t\tbackgroundColor: 'black'\r\n\t\t})\r\n\t\ttargetHeight = $(window).height() - 150\r\n\t\ttrigger.text('X')\r\n\t\ttarget.css('height', targetHeight).perfectScrollbar({\r\n\t\t\tsuppressScorllX: true\r\n\t\t})\r\n\t\treturn\r\n\r\n\tcloseMenu = ->\r\n\t\ttarget = MA.settings.mainMenu\r\n\t\ttrigger = MA.settings.menuTrigger\r\n\t\tMA.settings.mainMenuOpened = false\r\n\t\ttarget.parent().data('state', 'collapsed')\r\n\t\ttarget.hide().parent().removeClass('extended').css('height', 'auto')\r\n\t\tstickyNavSetup({\r\n\t\t\tcolor: 'black',\r\n\t\t\tbackgroundColor: 'transparent'\r\n\t\t\t# backgroundColor: if MA.settings.highlightVisible then 'transparent' else 'white'\r\n\t\t\t})\r\n\t\ttrigger.text('g')\r\n\t\treturn\r\n\r\n\tmenuToggle = (trigger, target) ->\r\n\t\ttrigger.click ->\r\n\t\t\tmainMenuState = target.parent().data('state')\r\n\t\t\tif mainMenuState == 'collapsed'\r\n\t\t\t\topenMenu()\r\n\t\t\telse\r\n\t\t\t\tcloseMenu()\r\n\r\n\tisotopeSetup = (target, item) ->\r\n\t\t$(window).load( ->\r\n\t\t\tgrid.isotope({\r\n\t\t\t\titemSelector: item,\r\n\t\t\t\tmasonry: {\r\n\t\t\t\t\tgutter: 15\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t)\r\n\r\n\tstickyNavSetup = (options) ->\r\n\t\tsettings = $.extend( {\r\n\t\t\t#defaults\r\n\t\t\tcolor: 'black',\r\n\t\t\tbackgroundColor: 'white'\r\n\t\t}, options )\r\n\r\n\t\tMA.settings.stickyNav.css( {\r\n\t\t\t'color': settings.color\r\n\t\t\t'backgroundColor': settings.backgroundColor\r\n\t\t} )\r\n\r\n\tsetNavBackground = (offsetElement) ->\r\n\t\toffset = $(offsetElement).height() - 125\r\n\t\tdirCount = [0, 0]\r\n\t\tdirection = ''\r\n\r\n\t\t$(window).scroll ->\r\n\t\t\tdirCount.pop()\r\n\t\t\tdirCount.push($(window).scrollTop())\r\n\t\t\tdirCount.reverse()\r\n\t\t\tdirection = if dirCount[0] > dirCount[1] then 'down' else 'up'\r\n\r\n\t\t# Highligt in!\r\n\t\t\tif $(window).scrollTop() < offset and  not MA.settings.mainMenuOpened\r\n\t\t\t\tstickyNavSetup({\r\n\t\t\t\t\tbackgroundColor: 'transparent'\r\n\t\t\t\t\t})\r\n\r\n\t\t\t# Highligt out!\r\n\t\t\tif $(window).scrollTop() >= offset and  not MA.settings.mainMenuOpened\r\n\t\t\t\tstickyNavSetup({\r\n\t\t\t\t\tbackgroundColor: 'white'\r\n\t\t\t\t\t})\r\n\t\treturn\r\n\r\n\r\n\tsetupHighlight: ->\r\n\t\tMA.settings.highlightOn = true\r\n\t\titems = $('.owl-carousel .item').length\r\n\t\t$('.owl-carousel').owlCarousel({\r\n\t\t\tloop: items > 1,\r\n\t\t\titems: 1,\r\n\t\t\tdots: true,\r\n\t\t\tsmartSpeed: 1000,\r\n\t\t\tautoplay: true,\r\n\t\t\tautoplayTimeout: 7000,\r\n\t\t\tsmartSpeed: 800\r\n\t\t\t# autoplayHoverPause: true\r\n\t\t})\r\n\t\tstickyNavSetup({\r\n\t\t\tbackgroundColor: 'transparent'\r\n\t\t})\r\n\r\n\t\t$('.slide-down a').click ->\r\n\t\t\thlHeight = $('.owl-carousel').height() - 125\r\n\t\t\tconsole.log 'Click!'\r\n\t\t\t$('html, body').animate({\r\n\t\t\t\tscrollTop: hlHeight\r\n\t\t\t}, 800)\r\n\r\n\t\tsetNavBackground('.owl-carousel')\r\n\t\treturn\r\n\r\n\tisScrolledIntoView = (elem) ->\r\n\t\t$elem = $(elem);\r\n\t\t$window = $(window);\r\n\r\n\t\tdocViewTop = $window.scrollTop();\r\n\t\tdocViewBottom = docViewTop + $window.height();\r\n\r\n\t\telemTop = $elem.offset().top;\r\n\t\telemBottom = elemTop + $elem.height();\r\n\r\n\t\treturn ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));\r\n\r\n\r\n\r\n\t# Public methods\r\n\tstickyNavSetup: (options) ->\r\n\t\tsettings = $.extend( {\r\n\t\t\t#defaults\r\n\t\t\tcolor: 'black',\r\n\t\t\tbackgroundColor: 'white'\r\n\t\t}, options )\r\n\r\n\t\tMA.settings.stickyNav.css( {\r\n\t\t\t'color': settings.color\r\n\t\t\t'backgroundColor': settings.backgroundColor\r\n\t\t} )\r\n\r\n\tiS: (options) ->\r\n\t\tsettings = $.extend\r\n\t\t\t#defaults\r\n\t\t\tgrid: MA.settings.grid\r\n\t\t\titem: MA.settings.gridItem\r\n\t\t\tslider: false\r\n\t\t\tsliderItem: $('.slider')\r\n\t\t\tsliderRange: [1965, 2016]\r\n\t\t\tquickSearch: false\r\n\t\t\tquickSearchField: $('.filters .search input[type = search]')\r\n\t\t\t, options\r\n\r\n\t\tsettings.grid.isotope\r\n\t\t\titemSelector: settings.gridItem,\r\n\t\t\tmasonry:\r\n\t\t\t\tgutter: 15\r\n\r\n\t\t#filtrowanie przyciskami\r\n\t\tgetHashFilter = ->\r\n\t\t\thash = location.hash\r\n\t\t\t# get filter=filterName\r\n\t\t\tmatches = location.hash.match(/filter=([^&]+)/i)\r\n\t\t\thashFilter = matches and matches[1]\r\n\t\t\thashFilter and decodeURIComponent(hashFilter)\r\n\r\n\t\tfilters = $('.filters li')\r\n\t\tfilterTriggers = $('.filters li a:not(.clear-filter)')\r\n\r\n\t\tclear = $('.filters li a.clear-filter')\r\n\t\tshowAll = $('.filters li.show-all')\r\n\r\n\t\tclear.click (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tfilters.removeClass 'inactive-filter'\r\n\t\t\t$(@).hide()\r\n\t\t\thistory.pushState '', document.title, window.location.pathname\r\n\t\t\tsettings.grid.isotope\r\n\t\t\t\tfilter: '*'\r\n\r\n\t\tshowAll.click (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tfilters.removeClass 'inactive-filter'\r\n\t\t\thistory.pushState '', document.title, window.location.pathname\r\n\t\t\tsettings.grid.isotope\r\n\t\t\t\tfilter: '*'\r\n\t\t\tif settings.slider\r\n\t\t\t\t\t\tsettings.sliderItem.slider 'values', [settings.sliderRange[0], settings.sliderRange[1]]\r\n\t\t\t\t\t\tupdateLegend settings.sliderRange[0], settings.sliderRange[1]\r\n\r\n\t\tfilterTriggers.click (e) ->\r\n\t\t\te.preventDefault()\r\n\t\t\tfilters.addClass 'inactive-filter'\r\n\t\t\t$(@).parent().removeClass 'inactive-filter'\r\n\t\t\tfilters.find('.clear-filter').hide()\r\n\t\t\t$(@).parent().find('.clear-filter').show()\r\n\t\t\tlocation.hash = 'filter=' + encodeURIComponent $(@).data('filter')\r\n\r\n\t\tonHashchange = ->\r\n\t\t\thashFilter = getHashFilter()\r\n\t\t\tif !hashFilter\r\n\t\t\t\treturn\r\n\t\t\t# filter isotope\r\n\t\t\tfilters.addClass 'inactive-filter'\r\n\t\t\tfilters.parent().find('.' + hashFilter).removeClass('inactive-filter').find('.clear-filter').show()\r\n\t\t\tsettings.grid.isotope\r\n\t\t\t\tfilter: '.' + hashFilter\r\n\r\n\t\t$(window).on 'hashchange', onHashchange\r\n\t\t# trigger event handler to init Isotope\r\n\t\tonHashchange()\r\n\r\n\t\t#filtrowanie sliderem\r\n\t\tupdateLegend = (sYear, eYear) ->\r\n\t\t\t\t$('.legend span').text(' ' + sYear + '–' + eYear)\r\n\r\n\t\tfilterIsotope = (sYear, eYear) ->\r\n\t\t\tsettings.quickSearchField.val('')\r\n\t\t\tvalue = $('.brick').filter( (index) ->\r\n\t\t\t\t$this = $(this)\r\n\t\t\t\tmatcharr = $this.attr('class').match(/brick\\s([0-9]*)/)\r\n\t\t\t\tif matcharr\r\n\t\t\t\t\tyear = parseInt(matcharr[1])\r\n\t\t\t\t\tif year >= sYear and year <= eYear then true else false\r\n\t\t\t\telse\r\n\t\t\t\t\tfalse\r\n\t\t\t)\r\n\t\t\tsettings.grid.isotope({filter:value})\r\n\r\n\t\tif settings.slider\r\n\t\t\t$('.slider')\r\n\t\t\t.slider\r\n\t\t\t\trange: true\r\n\t\t\t\tmin: settings.sliderRange[0]\r\n\t\t\t\tmax: settings.sliderRange[1]\r\n\t\t\t\tvalues: [settings.sliderRange[0], settings.sliderRange[1]]\r\n\t\t\t\tstop: (e, ui) ->\r\n\t\t\t\t\tfilterIsotope ui.values[0], ui.values[1]\r\n\t\t\t\t\tupdateLegend ui.values[0], ui.values[1]\r\n\t\t\t.slider 'pips',\r\n\t\t\t\tstep: 5\r\n\t\t\t.slider 'float'\r\n\t\t\tupdateLegend $('.slider').slider('values', 0), $('.slider').slider('values', 1)\r\n\r\n\t\t#filtrowanie przez QuickSearch\r\n\t\tqSOn = () -> #QuickSearhOn\r\n\t\t\t# QuickSearch\r\n\t\t\tform = $ '.filters .search form'\r\n\t\t\tclearBtn = $ '.filters .search input[type = reset]'\r\n\t\t\tqsRegex = undefined\r\n\r\n\t\t\tdebounce = (fn, threshold) ->\r\n\t\t\t\ttimeout = undefined\r\n\t\t\t\ttreshold = treshold | 100\r\n\t\t\t\treturn debounced = () ->\r\n\t\t\t\t\tclearTimeout timeout\r\n\t\t\t\t\targs = arguments\r\n\t\t\t\t\t_this = this\r\n\t\t\t\t\tdelayed = () ->\r\n\t\t\t\t\t\tfn.apply _this, args\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\ttimeout = setTimeout delayed, threshold\r\n\t\t\t\t\treturn\r\n\r\n\t\t\tsettings.quickSearchField.keyup debounce () ->\r\n\t\t\t\ttmp = settings.quickSearchField.val().split(' ')\r\n\t\t\t\t$.each tmp, (i, v) ->\r\n\t\t\t\t\ttmp[i] = '(?=.*' + v + ')'\r\n\r\n\t\t\t\tsearchStr = tmp.join('')\r\n\t\t\t\tqsRegExp = new RegExp searchStr + '.*', 'gi'\r\n\t\t\t\tsettings.grid.isotope\r\n\t\t\t\t\tfilter: ->\r\n\t\t\t\t\t\t$(this).text().match(qsRegExp)\r\n\t\t\t, 200\r\n\r\n\t\tif settings.quickSearch\r\n\t\t\tqSOn()\r\n\t\t\t$('.filters .search form').on 'reset', (e) ->\r\n\t\t\t\tsetTimeout ->\r\n\t\t\t\t\tsettings.grid.isotope\r\n\t\t\t\t\t\tfilter: '*'\r\n\t\t\t\t\tif settings.slider\r\n\t\t\t\t\t\tsettings.sliderItem.slider 'values', [settings.sliderRange[0], settings.sliderRange[1]]\r\n\t\t\t\t\t\tupdateLegend settings.sliderRange[0], settings.sliderRange[1]\r\n\t\t\t\t\treturn\r\n\t\t\t\treturn\r\n\t\t\tsettings.quickSearchField.focus ->\r\n\t\t\t\tsettings.sliderItem.slider 'values', [settings.sliderRange[0], settings.sliderRange[1]]\r\n\t\t\t\tupdateLegend settings.sliderRange[0], settings.sliderRange[1]\r\n\t\t\tconsole.log 'Quick Search is on'\r\n\t\t\treturn\r\n\r\n\r\n\tiSl: (options) -> #ta metoda nie jest uzywana, przeniosłem ją do MA.iS(), do usunięcia\r\n\t\tsettings = $.extend\r\n\t\t\t#defaults\r\n\t\t\tgrid: MA.settings.grid\r\n\t\t\tslider: $('.slider')\r\n\t\t\tsliderRange: [1965, 2016]\r\n\t\t\t, options\r\n\r\n\t\tupdateLegend = (sYear, eYear) ->\r\n\t\t\t\t$('.legend span').text(' ' + sYear + '–' + eYear)\r\n\r\n\t\tfilterIsotope = (sYear, eYear) ->\r\n\t\t\tvalue = $('.brick').filter( (index) ->\r\n\t\t\t\t$this = $(this)\r\n\t\t\t\tmatcharr = $this.attr('class').match(/brick\\s([0-9]*)/)\r\n\t\t\t\tif matcharr\r\n\t\t\t\t\tyear = parseInt(matcharr[1])\r\n\t\t\t\t\tif year >= sYear and year <= eYear then true else false\r\n\t\t\t\telse\r\n\t\t\t\t\tfalse\r\n\t\t\t)\r\n\t\t\t$('.bricks-container').isotope({filter:value})\r\n\r\n\t\t$.getScript '../../../workspace/js/jquery-ui.min.js', ->\r\n\t\t\t$.getScript '../../../workspace/js/jquery-ui-slider-pips.min.js', ->\r\n\t\t\t\t$('.slider')\r\n\t\t\t\t.slider\r\n\t\t\t\t\trange: true\r\n\t\t\t\t\tmin: settings.sliderRange[0]\r\n\t\t\t\t\tmax: settings.sliderRange[1]\r\n\t\t\t\t\tvalues: [settings.sliderRange[0], settings.sliderRange[1]]\r\n\t\t\t\t\tstop: (e, ui) ->\r\n\t\t\t\t\t\tfilterIsotope ui.values[0], ui.values[1]\r\n\t\t\t\t\t\tupdateLegend ui.values[0], ui.values[1]\r\n\t\t\t\t.slider 'pips',\r\n\t\t\t\t\tstep: 5\r\n\t\t\t\t.slider 'float'\r\n\t\t\t\tupdateLegend $('.slider').slider('values', 0), $('.slider').slider('values', 1)\r\n\r\n\tgetCountryCode: (lang, url) ->\r\n\t\tapiKey = \"7955c4b5554ea1387dad070d0ae194279a717795137ac2b3b1f884f4\"\r\n\t\t$.ajax\r\n\t\t\turl: \"https://api.ipdata.co/country_code?api-key=#{apiKey}\"\r\n\t\t\ttype: 'GET'\r\n\t\t\tdataType: 'text'\r\n\t\t\terror: (jqXHR, textStatus, errorThrown) ->\r\n\t\t\t\tconsole.log \"AJAX Error: #{textStatus}\"\r\n\t\t\tsuccess: (data, textStatus, jqXHR) ->\r\n\t\t\t\t#console.log \"Successful AJAX call: #{data}\"\r\n\t\t\t\tif data isnt 'PL' and lang isnt 'en'\r\n\t\t\t\t\twindow.location.replace \"#{url}\"\r\n\t\treturn\r\n\r\n\tgetCurrentLimit: ->\r\n\t\tapiKey = \"7955c4b5554ea1387dad070d0ae194279a717795137ac2b3b1f884f4\"\r\n\t\t$.ajax\r\n\t\t\turl: \"https://api.ipdata.co/count?api-key=#{apiKey}\"\r\n\t\t\ttype: \"GET\"\r\n\t\t\tdataType: \"text\"\r\n\t\t\terror: (jqXHR, textStatus, errorThrown) ->\r\n\t\t\t\tconsole.log \"AJAX Error: #{textStatus}\"\r\n\t\t\tsuccess: (data, textStatus, jqXHR) ->\r\n\t\t\t\tconsole.log \"Dziś użyto usługi #{data} razy. Dziś możesz z niej skorzystać jeszcze #{1500-data} razy.\"\r\n\t\treturn\r\n\r\n\r\n\t### COLLECTION SOLR ###\r\n\r\n\t# Ustala środowisko: local albo live\r\n\tenv = if window.location.origin.includes('ma.wroc.pl') then \"live\" else \"local\"\r\n\r\n\t# remove hanging single letters\r\n\tziomy = (string) ->\r\n\t\treturn string.replace /\\s\\b(a|i|o|u|w|z|A|I|O|U|W|Z|we|ul\\.)\\b\\s/gi, ' $1&nbsp;'\r\n\r\n\t# usuwa polskie znaki\r\n\tremovePL = (string, map) ->\r\n\t\tcurrentMap = $.extend {\r\n\t\t\tą: 'a'\r\n\t\t\tć: 'c'\r\n\t\t\tę: 'e'\r\n\t\t\tł: 'l'\r\n\t\t\tń: 'n'\r\n\t\t\tó: 'o'\r\n\t\t\tś: 's'\r\n\t\t\tż: 'z'\r\n\t\t\tź: 'z'\r\n\t\t}, map\r\n\t\ttempArray = string.toLowerCase().split('')\r\n\t\ttempArray.forEach (el, i) ->\r\n\t\t\tif currentMap[el]\r\n\t\t\t\ttempArray[i] = currentMap[el]\r\n\t\treturn tempArray.join('')\r\n\r\n\t#\ttemplete kafelka Isotope\r\n\r\n\t# ustala adres strony /solr-search\r\n\t# użycie: baseURL[env]\r\n\tbaseURL =\r\n\t\tlocal: \"#{window.location.origin}/ma.wroc.pl\"\r\n\t\tlive: \"#{window.location.origin}\"\r\n\t# ustala adres tunelu php (tunelSOLR[env])\r\n\ttunelSOLR =\r\n\t\tlocal: \"#{baseURL[env]}/workspace/tS.local.php\"\r\n\t\tlive: \"#{baseURL[env]}/workspace/tS.php\"\r\n\t#ustawienia kolejki pobierania\r\n\tstart = 0;\r\n\trows = 30;\r\n\tnumFound = 0;\r\n\r\n\t# ustala adres Directusa\r\n\t# użycie: directusURL[env]\r\n\tdirectusURL =\r\n\t\tlocal: 'http://127.0.0.1:4081'\r\n\t\tlive: 'http://156.17.251.36:59190'\r\n\r\n\t# loadImage = (src) ->\r\n\t# \tnew Promise( (resolve, reject) ->\r\n\t# \t\timg = new Image()\r\n\t# \t\timg.onload = () -> resolve(img)\r\n\t# \t\timg.onerror = () -> reject\r\n\t# \t\timg.src = src\r\n\t# \t)\r\n\r\n\ttemplate = (ob) ->\r\n\t\tnazwa =\r\n\t\t\tpl: if ob.nazwa_obiektu then ziomy(ob.nazwa_obiektu) else ''\r\n\t\t\ten: if ob.nazwa_obiektu_tlumaczenie then ob.nazwa_obiektu_tlumaczenie else ''\r\n\t\tnazwaObiektu = nazwa[MA.settings.currentLanguage]\r\n\t\tautorzy = if ob.autorzy then ob.autorzy.join(', ') else ''\r\n\t\tdatowanie = if ob.datowanie then ob.datowanie else ''\r\n\t\tobrazID = if ob.obraz_asset_url then \"#{ob.obraz_asset_url[0]}?key=brick-thumbnail\" else ''\r\n\t\t# obraz = if ob.obraz_asset_url then await $.get \"#{baseURL[env]}/collection/image/?img=#{obrazID}\" else \"\"\r\n\t\t# obraz = if ob.obraz_asset_url then await $.get \"#{baseURL[env]}/collection/image/?img=#{obrazID}\" else \"\"\r\n\t\tratio = if ob.obraz_width then ob.obraz_width[0] / 320 else 0\r\n\t\timgHeight = if ob.obraz_height then Math.floor( ob.obraz_height[0] / ratio ) else 0\r\n\t\tlink =\r\n\t\t\tpl: \"#{baseURL[env]}/pl/kolekcja/obiekt/#{ob.sygnatura_slug}/\"\r\n\t\t\ten: \"#{baseURL[env]}/en/collection/item/#{ob.sygnatura_slug}/\"\r\n\t\timg = if obrazID then \"\"\"\r\n\t\t\t<img\r\n\t\t\t\tclass=\"lazy\"\r\n\t\t\t  width=\"320\"\r\n\t\t\t  height=\"#{imgHeight}\"\r\n\t\t\t  src=\"#{baseURL[env]}/workspace/images/blank.gif\"\r\n\t\t\t\tdata-original = \"http://ma.wroc.pl/workspace/t.php?link=#{obrazID}\"\r\n\t\t\t  alt=\"#{autorzy}, #{nazwaObiektu}\"\r\n\t\t\t/>\r\n\t\t\"\"\" else \"\"\r\n\t\t$(\"\"\"\r\n\t\t\t<article class=\"brick\">\r\n\t\t\t\t<a href=\"#{link[MA.settings.currentLanguage]}\">\r\n\t\t\t\t\t<h1 class=\"donthyphenate\">#{nazwaObiektu}</h1>\r\n\t\t\t\t\t<h2 class=\"donthyphenate\">#{autorzy}</h2>\r\n\t\t\t    <p>#{datowanie}</p>\r\n\t\t\t\t\t#{img}\r\n\t\t\t\t</a>\r\n\t\t\t</article>\r\n\t\t\"\"\")\r\n\r\n\t# odmina słowa obiekt\r\n\tpolishPlural = (value) ->\r\n\t\tsingularNominativ = 'obiekt'\r\n\t\tpluralNominativ = 'obiekty'\r\n\t\tpluralGenitive = 'obiektów'\r\n\t\tif value == 1\r\n\t\t\treturn \"#{value} #{singularNominativ}\"\r\n\t\telse if value % 10 >= 2 and value %10 <= 4 and (value % 100 < 10 or value % 100 >= 20)\r\n\t\t\treturn \"#{value} #{pluralNominativ}\"\r\n\t\telse\r\n\t\t\treturn \"#{value} #{pluralGenitive}\"\r\n\r\n\t# askSOLR – dodaje do kontenera Isotope nowe kafle\r\n\taskSOLR: (q, start = 0) ->\r\n\t\tloader = $('div.load7')\r\n\t\tif q == ''\r\n\t\t\treturn\r\n\t\turl = \"#{tunelSOLR[env]}?link=ma_collection/select&q=#{q}&start=#{start}&rows=#{rows}\"\r\n\t\tlastPage = ''\r\n\t\tloader.show()\r\n\t\t# start += rows\r\n\t\tfetch url\r\n\t\t\t.then (response) ->\r\n\t\t\t\tresJSON = await response.json()\r\n\t\t\t\tnumFound = resJSON.response.numFound\r\n\t\t\t\tlastPage = Math.ceil numFound / rows\r\n\t\t\t\t$('p.results-found .number').text(\"Znaleziono #{polishPlural(numFound)}\").removeClass('loading')\r\n\t\t\t\tpagination(start, lastPage, q)\r\n\t\t\t\tresJSON.response.docs.forEach (doc, i) ->\r\n\t\t\t\t\tMA.settings.grid.isotope('insert', await template(doc))\r\n\t\t\t\t\tif  i + 1 == resJSON.response.docs.length\r\n\t\t\t\t\t\tloader.hide()\r\n\t\t\t\t\t\t$('div.pagination').show()\r\n\t\t\t\t\t\t$('img.lazy').lazyload({\r\n\t\t\t\t\t\t\tthreshold: 1000,\r\n\t\t\t\t\t\t\tfailure_limit : 1000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t#  scroluje do pozycji zapisanej przy opuszczaniu strony\r\n\t\t\t\t\t\t# patrz JS w collection_search.xsl\r\n\t\t\t\t\t\tif parseInt(sessionStorage.getItem('startIndex')) == start\r\n\t\t\t\t\t\t\twindow.scroll({\r\n\t\t\t\t\t\t\t\ttop: sessionStorage.getItem('scrollPosition'),\r\n\t\t\t\t\t\t\t\tbehavior: 'smooth'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t.catch (error) ->\r\n\t\t\t\tconsole.error error\r\n\t\t\treturn\r\n\r\n\t# pagination\r\n\tpagination = (start, lastPage, q) ->\r\n\t\tq = if q == '*' then '' else q\r\n\t\tpaginationList = $('ul.pagination__list')\r\n\t\tpage = start / rows + 1\r\n\t\tpagStart = page - 3\r\n\t\tpagMax = if (page + 3) > lastPage then lastPage else page + 3\r\n\t\turl =\r\n\t\t\tpl: \"#{baseURL[env]}/pl/kolekcja/wyszukiwarka\"\r\n\t\t\ten: \"#{baseURL[env]}/en/collection/search\"\r\n\t\txItems = []\r\n\t\tfor i  in [pagStart..pagMax]\r\n\t\t\tif i < 1\r\n\t\t\t\tnewPage = Math.abs(i) + pagMax + 1\r\n\t\t\t\tif newPage >= lastPage then continue\r\n\t\t\t\txItems.unshift \"<li><a href='#{url[MA.settings.currentLanguage]}?q=#{q}&start=#{(newPage - 1) * 30}'>#{newPage}</a></li>\"\r\n\t\t\telse if i == page then paginationList.append(\"<li><a class='active' href='#{url[MA.settings.currentLanguage]}?q=#{q}&start=#{(i - 1) * 30}'>#{i}</a></li>\")\r\n\t\t\telse paginationList.append(\"<li><a href='#{url[MA.settings.currentLanguage]}?q=#{q}&start=#{(i - 1) * 30}'>#{i}</a></li>\")\r\n\t\tif page > 4 then paginationList.prepend(\"<li><a href='#{url[MA.settings.currentLanguage]}?q=#{q}&start=0'>1</a></li><li class='inactive'>…</li>\")\r\n\t\tpaginationList.append(xItems)\r\n\t\tif pagMax != lastPage then paginationList.append(\"<li class='inactive'>…</li><li><a href='#{url[MA.settings.currentLanguage]}?q=#{q}&start=#{(lastPage - 1) * 30}'>#{lastPage}</a></li>\")\r\n\t\tif page != 1 then paginationList.prepend(\"<li><a class='prev-page button' href='#{url[MA.settings.currentLanguage]}?q=#{q}&start=#{(page - 2) * 30}'>POPRZEDNIA</a></li>\")\r\n\t\tif page != lastPage then paginationList.append(\"<li><a class='next-page button' href='#{url[MA.settings.currentLanguage]}?q=#{q}&start=#{(page * 30)}'>NASTĘPNA</a></li>\")\r\n\r\n\t# suggester\r\n\tsuggesterURL = \"#{baseURL[env]}/collection/collection-search-suggestions/\"\r\n\tcurrentSuggest = -1\r\n\tlistSuggest = null\r\n\r\n\t# wyświetla podpowiedzi do wyszukiwania\r\n\tprintSuggestions = (suggestions) ->\r\n\t\ttempURL =\r\n\t\t\tpl: \"#{baseURL[env]}/pl/kolekcja/wyszukiwarka?q=\"\r\n\t\t\ten: \"#{baseURL[env]}/en/collection/search?q=\"\r\n\t\tMA.settings.suggester.empty()\r\n\t\tsuggestions.forEach (item) ->\r\n\t\t\tif typeof item == 'number' then return\r\n\t\t\titem = item.replace(/[„”\"']/g, '')\r\n\t\t\turl = tempURL[MA.settings.currentLanguage] + encodeURIComponent item\r\n\t\t\tMA.settings.suggester.append(\"<li><a href='#{url}'>#{item}</a></li>\")\r\n\t\tcurrentSuggest = -1\r\n\t\tlistSuggest = document.querySelectorAll('ul.suggester li')\r\n\r\n\t# pobiera podpowiedzi do wyszukiwania\r\n\tsuggest = (q) ->\r\n\t\turl = \"#{tunelSOLR[env]}?link=ma_collection/terms&terms.limit=10&terms.fl=autocomplete&terms.regex.flag=case_insensitive&terms.regex=.*#{decodeURI(q).replace(/\\s/g, '.')}.*\"\r\n\t\tfetch url\r\n\t\t\t.then (res) ->\r\n\t\t\t\tresJSON = await res.json()\r\n\t\t\t\t# console.log resJSON.terms.autocomplete\r\n\t\t\t\tif resJSON.terms.autocomplete.length > 0\r\n\t\t\t\t\tMA.settings.suggester.show()\r\n\t\t\t\t\tprintSuggestions resJSON.terms.autocomplete\r\n\t\t\t.catch (err) ->\r\n\t\t\t\tconsole.error err\r\n\r\n\tsugg: (trg) ->\r\n\t\ttrg.keyup (e) ->\r\n\t\t\tif !$(this).val()\r\n\t\t\t\tMA.settings.suggester.hide()\r\n\t\t\t\treturn\r\n\t\t\tswitch e.which\r\n\t\t\t\twhen 38\r\n\t\t\t\t\tif currentSuggest != -1 then listSuggest[currentSuggest].classList.remove 'highlight'\r\n\t\t\t\t\tif currentSuggest > 0 then currentSuggest--\r\n\t\t\t\t\telse currentSuggest = listSuggest.length - 1\r\n\t\t\t\t\tlistSuggest[currentSuggest].classList.add 'highlight'\r\n\t\t\t\twhen 40\r\n\t\t\t\t\tif currentSuggest != -1 then listSuggest[currentSuggest].classList.remove 'highlight'\r\n\t\t\t\t\tif currentSuggest < listSuggest.length - 1 then currentSuggest++\r\n\t\t\t\t\telse currentSuggest = 0\r\n\t\t\t\t\tlistSuggest[currentSuggest].classList.add 'highlight'\r\n\t\t\t\twhen 13\r\n\t\t\t\t\ttrg.val(listSuggest[currentSuggest].firstChild.textContent).submit()\r\n\t\t\t\telse suggest encodeURIComponent $(this).val()\r\n\r\n\r\n\tapiTest = ->\r\n\t\tconsole.log 'Public API available!'\r\n\r\n\t# Public API\r\n\tapi:\r\n\t\tapiTest: apiTest\r\n\t\topenMenu: openMenu\r\n\t\tcloseMenu: closeMenu\r\n\t\tsetNavBackground: setNavBackground\r\n\t\tisotopeSetup: isotopeSetup\r\n\t\tgrid: MA.settings.grid\r\n\t\tremovePL: removePL\r\n\t\tpolishPlural: polishPlural\r\n\r\n\t# Initialize\r\n\tinit: ->\r\n\t\tsearchToggle(searchTrigger, searchForm)\r\n\t\tmenuToggle(menuTrigger, mainMenu)\r\n\t\t#isotopeSetup(grid, gridItem) # poprawić --> nie na wszystkich stronach\r\n\t\tHyphenator.config({\r\n\t\t\torphancontrol: 2\r\n\t\t\tdefaultlanguage: 'pl'\r\n\t\t\tminwordlength: 8\r\n\t\t})\r\n\t\tHyphenator.run()\r\n\r\n\r\nwindow.MA = new MA()\r\n\r\n# jQuery\r\n$ ->\r\n\twindow.MA.init()\r\n\r\n\t# kids-n-parents -> Warsztaty\r\n\twBtn = $('.kids-n-parents a.workshop')\r\n\twMore = $('.kids-n-parents .more')\r\n\twBtn.click (e) ->\r\n\t\te.preventDefault()\r\n\t\twMore.slideToggle()\r\n"]}